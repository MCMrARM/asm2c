from capstone.x86 import *

X86_CONDITIONAL_INSTRUCTIONS = [
    X86_INS_JE,
    X86_INS_JNE,
    X86_INS_JA,
    X86_INS_JAE,
    X86_INS_JB,
    X86_INS_JBE,
    X86_INS_JG,
    X86_INS_JGE,
    X86_INS_JL,
    X86_INS_JLE,
    X86_INS_JNO,
    X86_INS_JNP,
    X86_INS_JNS,
    X86_INS_JO,
    X86_INS_JP,
    X86_INS_JS,
    X86_INS_JCXZ,
    X86_INS_JECXZ
]

X86_JUMP_INSTRUCTIONS = [
    X86_INS_JMP
]

X86_TERMINATING_INSTRUCTIONS = [
    X86_INS_RET,
    X86_INS_RETF,
    X86_INS_RETFQ,
    X86_INS_HLT,
    X86_INS_INT3,
    *X86_CONDITIONAL_INSTRUCTIONS,
    *X86_JUMP_INSTRUCTIONS
]

X86_REGISTERS = [
    ('RAX', X86_REG_RAX, X86_REG_EAX, X86_REG_AX, X86_REG_AL, X86_REG_AH),
    ('RBP', X86_REG_RBP, X86_REG_EBP, X86_REG_BP, X86_REG_BPL, None),
    ('RBX', X86_REG_RBX, X86_REG_EBX, X86_REG_BX, X86_REG_BL, X86_REG_BH),
    ('RCX', X86_REG_RCX, X86_REG_ECX, X86_REG_CX, X86_REG_CL, X86_REG_CH),
    ('RDI', X86_REG_RDI, X86_REG_EDI, X86_REG_DI, X86_REG_DIL, None),
    ('RDX', X86_REG_RDX, X86_REG_EDX, X86_REG_DX, X86_REG_DL, X86_REG_DH),
    ('RSI', X86_REG_RSI, X86_REG_ESI, X86_REG_SI, X86_REG_SIL, None),
    ('RSP', X86_REG_RSP, X86_REG_ESP, X86_REG_SP, X86_REG_SPL, None),
    ('R8', X86_REG_R8, X86_REG_R8D, X86_REG_R8W, X86_REG_R8B, None),
    ('R9', X86_REG_R9, X86_REG_R9D, X86_REG_R9W, X86_REG_R9B, None),
    ('R10', X86_REG_R10, X86_REG_R10D, X86_REG_R10W, X86_REG_R10B, None),
    ('R11', X86_REG_R11, X86_REG_R11D, X86_REG_R11W, X86_REG_R11B, None),
    ('R12', X86_REG_R12, X86_REG_R12D, X86_REG_R12W, X86_REG_R12B, None),
    ('R13', X86_REG_R13, X86_REG_R13D, X86_REG_R13W, X86_REG_R13B, None),
    ('R14', X86_REG_R14, X86_REG_R14D, X86_REG_R14W, X86_REG_R14B, None),
    ('R15', X86_REG_R15, X86_REG_R15D, X86_REG_R15W, X86_REG_R15B, None),
]
X86_128_REGISTERS = [
    ('XMM' + str(i), X86_REG_XMM0 + i) for i in range(32)
]


FLAG_ZF = 1
FLAG_SF = 2
FLAG_CF = 4
FLAG_OF = 8
FLAG_AF = 16
FLAG_PF = 32

X86_JUMP_FLAGS = {
    X86_INS_JE: FLAG_ZF,
    X86_INS_JNE: FLAG_ZF,
    X86_INS_JA: FLAG_CF | FLAG_ZF,
    X86_INS_JAE: FLAG_CF,
    X86_INS_JB: FLAG_CF,
    X86_INS_JBE: FLAG_CF | FLAG_ZF,
    X86_INS_JG: FLAG_ZF | FLAG_SF | FLAG_OF,
    X86_INS_JGE: FLAG_SF | FLAG_OF,
    X86_INS_JL: FLAG_SF | FLAG_OF,
    X86_INS_JLE: FLAG_ZF | FLAG_SF | FLAG_OF,
    X86_INS_JNO: FLAG_OF,
    X86_INS_JNP: FLAG_PF,
    X86_INS_JNS: FLAG_SF,
    X86_INS_JO: FLAG_OF,
    X86_INS_JP: FLAG_PF,
    X86_INS_JS: FLAG_SF
}
X86_CMOV_TO_JMP = {
    X86_INS_CMOVE: X86_INS_JE,
    X86_INS_CMOVNE: X86_INS_JNE,
    X86_INS_CMOVA: X86_INS_JA,
    X86_INS_CMOVAE: X86_INS_JAE,
    X86_INS_CMOVB: X86_INS_JB,
    X86_INS_CMOVBE: X86_INS_JBE,
    X86_INS_CMOVG: X86_INS_JG,
    X86_INS_CMOVGE: X86_INS_JGE,
    X86_INS_CMOVL: X86_INS_JL,
    X86_INS_CMOVLE: X86_INS_JLE,
    X86_INS_CMOVNO: X86_INS_JNO,
    X86_INS_CMOVNP: X86_INS_JNP,
    X86_INS_CMOVNS: X86_INS_JNS,
    X86_INS_CMOVO: X86_INS_JO,
    X86_INS_CMOVP: X86_INS_JP,
    X86_INS_CMOVS: X86_INS_JS
}
X86_SET_TO_JMP = {
    X86_INS_SETE: X86_INS_JE,
    X86_INS_SETNE: X86_INS_JNE,
    X86_INS_SETA: X86_INS_JA,
    X86_INS_SETAE: X86_INS_JAE,
    X86_INS_SETB: X86_INS_JB,
    X86_INS_SETBE: X86_INS_JBE,
    X86_INS_SETG: X86_INS_JG,
    X86_INS_SETGE: X86_INS_JGE,
    X86_INS_SETL: X86_INS_JL,
    X86_INS_SETLE: X86_INS_JLE,
    X86_INS_SETNO: X86_INS_JNO,
    X86_INS_SETNP: X86_INS_JNP,
    X86_INS_SETNS: X86_INS_JNS,
    X86_INS_SETO: X86_INS_JO,
    X86_INS_SETP: X86_INS_JP,
    X86_INS_SETS: X86_INS_JS
}